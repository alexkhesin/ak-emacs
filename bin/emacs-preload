#!/bin/bash
# Usage: preload-emacs <name>
#
# Preloads the Emacs daemon instance called NAME.
# Does nothing if the instance is already running.

name="$1"
serverdir="${TMPDIR:-/tmp}/emacs$UID"

if [ "$(uname -s)" = "Darwin" ]; then
  emacs=/Applications/Emacs.app/Contents/MacOS/Emacs
elif [ -e /usr/local/bin/emacs ]; then
  emacs=/usr/local/bin/emacs
else
  emacs=/usr/bin/emacs
fi

if [ -z "$name" ]; then
    echo "Usage: preload_emacs <name> [<waitp>]" >&2
    exit 1
fi

if [ ! -e "$serverdir/$name" ]; then
     "$emacs" --daemon="$name"
fi
